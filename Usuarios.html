<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usuarios - Sistema de Inventario</title>
  <link rel="stylesheet" href="./front/styles.css" />
</head>

<body>
  <!-- Barra superior -->
  <div class="navbar">
    <h1>SISTEMA DE INVENTARIO</h1>
    <div class="menu">
      <a href="Interfaz.html">INVENTARIO</a>
      <a href="SistemaVentasAdmin.html">VENTA</a>
      <a href="ReportesAdmin.html">REPORTES</a>
      <a href="Usuarios.html">USUARIOS</a>
      <a href="index.html">⮐ SALIR</a>
    </div>
  </div>

  <!-- Contenido principal -->
  <div class="main-content">
    <div class="users-grid" id="usersGrid"></div>
  </div>

  <!-- Botón para agregar usuario -->
  <button class="add-user-btn" onclick="openAddUserModal()">+</button>

  <!-- Modal para agregar usuario -->
  <div id="addUserModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>AGREGAR USUARIO</h2>
        <button class="close-btn" onclick="closeAddUserModal()">&times;</button>
      </div>
      <form id="addUserForm">
        <div class="form-group">
          <label for="userName">NOMBRE COMPLETO</label>
          <input type="text" id="userName" required placeholder="Ingresa el nombre completo" />
        </div>
        <div class="form-group">
          <label for="userRole">ROL</label>
          <select id="userRole" required>
            <option value="">Selecciona un rol</option>
            <option value="ADMIN">ADMIN</option>
            <option value="Supervisor">Supervisor</option>
            <option value="Cajero">Cajero</option>
          </select>
        </div>
        <div class="form-group">
          <label for="userEmail">EMAIL</label>
          <input type="email" id="userEmail" required placeholder="Ingresa el email" />
        </div>
        <div class="form-group">
          <label for="userPassword">CONTRASEÑA</label>
          <input type="password" id="userPassword" required placeholder="Ingresa la contraseña" />
        </div>
        <div class="modal-buttons">
          <button type="button" class="btn-cancel" onclick="closeAddUserModal()">CANCELAR</button>
          <button type="submit" class="btn-save">GUARDAR</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal de confirmación de contraseña -->
  <div id="passwordConfirmModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>CONFIRMACIÓN REQUERIDA</h2>
        <button class="close-btn" onclick="closePasswordConfirmModal()">&times;</button>
      </div>
      <div class="password-confirm">
        <h4>⚠️ CONTRASEÑA DE ADMINISTRADOR REQUERIDA</h4>
        <p>Para modificar usuarios, debe ingresar la contraseña de administrador.</p>
      </div>
      <form id="passwordConfirmForm">
        <div class="form-group">
          <label for="adminPassword">CONTRASEÑA DE ADMINISTRADOR</label>
          <input type="password" id="adminPassword" required placeholder="Ingrese la contraseña de administrador" />
          <div class="error-message" id="passwordError">Contraseña incorrecta. Intente nuevamente.</div>
        </div>
        <div class="modal-buttons">
          <button type="button" class="btn-cancel" onclick="closePasswordConfirmModal()">CANCELAR</button>
          <button type="submit" class="btn-save">CONFIRMAR</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal para editar usuario -->
  <div id="editUserModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>EDITAR USUARIO</h2>
        <button class="close-btn" onclick="closeEditUserModal()">&times;</button>
      </div>
      <form id="editUserForm">
        <input type="hidden" id="editUserId" />
        <div class="form-group">
          <label for="editUserName">NOMBRE COMPLETO</label>
          <input type="text" id="editUserName" required placeholder="Ingresa el nombre completo" />
        </div>
        <div class="form-group">
          <label for="editUserRole">ROL</label>
          <select id="editUserRole" required>
            <option value="">Selecciona un rol</option>
            <option value="ADMIN">ADMIN</option>
            <option value="Supervisor">Supervisor</option>
            <option value="Cajero">Cajero</option>
          </select>
        </div>
        <div class="form-group">
          <label for="editUserEmail">EMAIL</label>
          <input type="email" id="editUserEmail" required placeholder="Ingresa el email" />
        </div>
        <div class="form-group">
          <label for="editUserPassword">CONTRASEÑA (dejar en blanco para no cambiar)</label>
          <input type="password" id="editUserPassword" placeholder="Nueva contraseña" />
        </div>
        <div class="modal-buttons">
          <button type="button" class="btn-cancel" id="openDeleteUserConfirmBtn">ELIMINAR</button>
          <button type="submit" class="btn-save">ACTUALIZAR</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal doble confirmación eliminar (ESTILO B: ancho similar) -->
  <div id="deleteUserConfirmModal" class="modal">
    <div class="modal-content">
      <div class="modal-header delete-modal-header">
        <h2>ELIMINAR USUARIO</h2>
        <button class="close-btn" onclick="closeDeleteUserConfirmModal()">&times;</button>
      </div>
      <div class="warning-text" style="margin:8px 0 16px;">
        ⚠️ Esta acción es <strong>permanente</strong> y no se puede deshacer.
      </div>
      <div class="separator"></div>
      <div class="modal-buttons">
        <button type="button" class="btn-cancel" onclick="closeDeleteUserConfirmModal()">CANCELAR</button>
        <button type="button" class="btn-confirm-delete" id="deleteUserBtn">ELIMINAR DEFINITIVAMENTE</button>
      </div>
    </div>
  </div>
<script src="./front/usuarios.js"></script>

  <style>
    /* Toast interno de sistema (4s) */
    .system-warning {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #fff3cd;
      color: #856404;
      border: 2px solid #ffeeba;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.25);
      z-index: 9999;
      animation: fadeIn 0.25s ease;
      font-weight: bold;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(12px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Encabezado rojo para los modales de eliminación (coincide con Interfaz.html) */
    .delete-modal-header {
      background: #ffeded;
      border-bottom: 1px solid #ffc8c8;
    }
    .delete-modal-header h2 {
      color: #b30000;
    }

    .warning-text {
      color: #8a6d3b;
      background: #fcf8e3;
      border: 1px solid #faebcc;
      padding: 10px 12px;
      border-radius: 6px;
    }

    .separator {
      height: 1px;
      background: #eee;
      margin: 10px 0 16px;
    }

    .btn-confirm-delete {
      background: #d9534f;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
    }
    .btn-confirm-delete:hover {
      filter: brightness(0.95);
    }
  </style>
</body>
</html>
